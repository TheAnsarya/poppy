# üìã GitHub Issues for v1.0.0 Release

**Project:** Poppy Compiler
**Created:** January 14, 2026
**Purpose:** Issue specifications for final v1.0.0 push

---

## üè∑Ô∏è Labels to Create

| Label | Color | Description |
|-------|-------|-------------|
| `P0-critical` | `#d73a4a` | Must fix for release |
| `P1-important` | `#ff9f1c` | Should fix for release |
| `P2-nice-to-have` | `#2ec4b6` | Can defer |
| `snes` | `#7057ff` | SNES/65816 related |
| `gameboy` | `#008672` | Game Boy related |
| `codegen` | `#fbca04` | Code generation |
| `parser` | `#d4c5f9` | Parser/Lexer |
| `release` | `#e99695` | Release preparation |
| `testing` | `#0e8a16` | Test coverage |
| `example` | `#c2e0c6` | Example projects |
| `vscode` | `#0078d7` | VS Code extension |

---

## üìù Issue Specifications

### Issue: Bank:Address Notation Parsing

**Title:** `[SNES] Bank:Address notation parsing ($bb:aaaa syntax)`

**Labels:** `P0-critical`, `snes`, `parser`, `enhancement`

**Parent:** #75 (SNES Completion Epic)

**Description:**

```markdown
## Summary
Add support for bank:address notation commonly used in SNES development.

## Problem
SNES uses 24-bit addressing with bank bytes. The common notation `$7e:1234` is not currently supported. Users must manually calculate: `$7e1234`.

## Solution
Update the Lexer and Parser to recognize the `:` separator in hexadecimal addresses.

## Syntax
```asm
lda $7e:1234        ; Load from bank $7e, address $1234
jml $c0:8000        ; Long jump to bank $c0
sta.l $00:0000      ; Explicit long store
lda [$10]           ; Use 24-bit pointer
```

## Implementation
1. Lexer: Recognize `$bb:aaaa` pattern as single HexNumber token
2. Parser: Parse bank:address as `(bank << 16) | address`
3. Support in all expression contexts

## Acceptance Criteria
- [ ] Parser recognizes `$bb:aaaa` syntax
- [ ] Evaluates to correct 24-bit value
- [ ] Works in immediate mode: `lda #$7e:0000`
- [ ] Works in absolute mode: `lda $7e:1234`
- [ ] Unit tests cover edge cases
- [ ] No regression in existing hex parsing

## Test Cases
```asm
; Basic parsing
lda $7e:1234        ; Should become $7e1234

; With expressions
lda $00:($1000+$20) ; Should evaluate correctly

; Edge cases
lda $ff:ffff        ; Maximum value
lda $00:0000        ; Minimum value
```

## Estimated Time: 3 hours
```

---

### Issue: SNES ROM Layout Builder

**Title:** `[SNES] Proper ROM layout with header at correct offset`

**Labels:** `P0-critical`, `snes`, `codegen`, `enhancement`

**Parent:** #75

**Description:**

```markdown
## Summary
Create SnesRomBuilder to place the internal header at the correct ROM offset.

## Problem
Currently, Poppy prepends the SNES header to the ROM. However, SNES ROMs require the header at specific locations:
- LoROM: $007fc0-$007fff
- HiROM: $00ffc0-$00ffff

## Solution
Create `SnesRomBuilder` class that:
1. Collects all code segments
2. Calculates proper ROM size (power of 2)
3. Places header at correct offset
4. Fills gaps with $00 or $ff
5. Calculates and inserts checksum

## ROM Structure (LoROM 256KB)
```
$000000-$007fbf: Code/Data
$007fc0-$007fff: Internal Header (64 bytes)
$008000-$03ffff: More Code/Data
```

## Implementation
1. Create `SnesRomBuilder.cs` in CodeGen
2. Calculate header offset from mapping mode
3. Pad ROM data to reach header location
4. Insert header at correct position
5. Calculate complement checksum
6. Update CodeGenerator to use builder

## Acceptance Criteria
- [ ] Header placed at $7fc0 for LoROM
- [ ] Header placed at $ffc0 for HiROM
- [ ] ROM padded to power of 2 size
- [ ] Checksum correctly calculated
- [ ] Complement checksum correct
- [ ] Works with bsnes emulator

## Estimated Time: 4 hours
```

---

### Issue: SNES Checksum Calculation

**Title:** `[SNES] Calculate and insert ROM checksum`

**Labels:** `P0-critical`, `snes`, `codegen`, `enhancement`

**Parent:** #75

**Description:**

```markdown
## Summary
Implement SNES ROM checksum calculation for header bytes $2c-$2f.

## Algorithm
1. Sum all bytes in ROM (16-bit, wrap on overflow)
2. Store complement at header offset $2c-$2d
3. Store checksum at header offset $2e-$2f
4. checksum + complement = $ffff

## Implementation
```csharp
ushort CalculateChecksum(byte[] rom) {
    ushort sum = 0;
    foreach (var b in rom) {
        sum += b;
    }
    return sum;
}
```

## Header Layout (Offsets from header start)
| Offset | Size | Content |
|--------|------|---------|
| $2c | 2 | Complement checksum |
| $2e | 2 | Checksum |

## Acceptance Criteria
- [ ] Checksum algorithm matches SNES spec
- [ ] Complement calculated correctly
- [ ] ROM validates in emulators
- [ ] Header shows correct values

## Estimated Time: 2 hours
```

---

### Issue: SNES Integration Tests

**Title:** `[SNES] End-to-end ROM generation tests`

**Labels:** `P1-important`, `snes`, `testing`

**Parent:** #75

**Description:**

```markdown
## Summary
Create comprehensive integration tests for SNES ROM generation.

## Test Cases
1. **Minimal ROM** - Just reset vector
2. **LoROM Layout** - Verify header at $7fc0
3. **HiROM Layout** - Verify header at $ffc0
4. **Checksum Verification** - Correct checksum in header
5. **Full Header** - All header fields populated
6. **Bank Crossing** - Code spanning multiple banks
7. **M/X Sizing** - Verify immediate operand sizes

## Test Structure
```csharp
[Fact]
public void Generate_LoRomWithHeader_HeaderAt7FC0() {
    var source = @"
.snes
.lorom
.snes_title ""TEST""
.org $8000
    sei
    jmp $8000
";
    // Compile and verify header offset
}
```

## Acceptance Criteria
- [ ] Tests cover all SNES mapping modes
- [ ] Header placement verified
- [ ] Checksum verified
- [ ] Bank crossing works
- [ ] At least 10 new tests

## Estimated Time: 3 hours
```

---

### Issue: SNES Hello World Example

**Title:** `[SNES] Create hello-world example project`

**Labels:** `P1-important`, `snes`, `example`, `documentation`

**Parent:** #75

**Description:**

```markdown
## Summary
Create a complete SNES hello-world example that displays text on screen.

## Contents
```
examples/snes-hello-world/
‚îú‚îÄ‚îÄ main.pasm           # Main source
‚îú‚îÄ‚îÄ poppy.json          # Project config
‚îú‚îÄ‚îÄ README.md           # Instructions
‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îî‚îÄ‚îÄ snes.inc        # SNES definitions
‚îî‚îÄ‚îÄ graphics/
    ‚îî‚îÄ‚îÄ font.chr        # 8x8 font tiles
```

## Example Code
```asm
; main.pasm - SNES Hello World
.snes
.lorom

.snes_title "HELLO WORLD"
.snes_region "USA"
.snes_rom_size 256

.include "include/snes.inc"

.org $8000
reset:
    sei
    clc
    xce
    ; ... display "HELLO WORLD" ...
```

## Acceptance Criteria
- [ ] Compiles without errors
- [ ] Runs in bsnes/Mesen
- [ ] Displays text on screen
- [ ] Well-commented code
- [ ] README with instructions

## Estimated Time: 2 hours
```

---

### Issue: Game Boy ROM Header Placement

**Title:** `[GB] ROM header placement at $0100-$014f`

**Labels:** `P0-critical`, `gameboy`, `codegen`, `enhancement`

**Parent:** #48

**Description:**

```markdown
## Summary
Ensure Game Boy ROM header is placed at the correct location ($0100-$014f).

## GB ROM Structure
```
$0000-$00ff: RST handlers and interrupt vectors
$0100-$0103: Entry point (usually NOP, JP $0150)
$0104-$0133: Nintendo logo (required)
$0134-$0143: Game title (15/11 chars)
$0144-$0145: New licensee code
$0146: SGB flag
$0147: Cartridge type
$0148: ROM size
$0149: RAM size
$014a: Destination code
$014b: Old licensee code
$014c: ROM version
$014d: Header checksum
$014e-$014f: Global checksum
```

## Implementation
1. Create `GbRomBuilder.cs` in CodeGen
2. Place code/data around header area
3. Insert header at $0100
4. Calculate and insert checksums

## Acceptance Criteria
- [ ] Header at $0100-$014f
- [ ] Nintendo logo included
- [ ] Checksums calculated
- [ ] ROM boots in bgb/Gambatte

## Estimated Time: 2 hours
```

---

### Issue: Game Boy Checksum Calculation

**Title:** `[GB] Calculate header and global checksums`

**Labels:** `P0-critical`, `gameboy`, `codegen`, `enhancement`

**Parent:** #48

**Description:**

```markdown
## Summary
Implement Game Boy ROM checksum calculations.

## Header Checksum ($014d)
```csharp
byte HeaderChecksum(byte[] rom) {
    byte sum = 0;
    for (int i = 0x134; i <= 0x14c; i++) {
        sum = (byte)(sum - rom[i] - 1);
    }
    return sum;
}
```

## Global Checksum ($014e-$014f)
```csharp
ushort GlobalChecksum(byte[] rom) {
    ushort sum = 0;
    for (int i = 0; i < rom.Length; i++) {
        if (i != 0x14e && i != 0x14f) {
            sum += rom[i];
        }
    }
    return sum;
}
```

## Acceptance Criteria
- [ ] Header checksum correct
- [ ] Global checksum correct
- [ ] ROM passes bgb validation

## Estimated Time: 1 hour
```

---

### Issue: Game Boy Integration Tests

**Title:** `[GB] End-to-end ROM generation tests`

**Labels:** `P1-important`, `gameboy`, `testing`

**Parent:** #48

**Description:**

```markdown
## Summary
Create comprehensive integration tests for Game Boy ROM generation.

## Test Cases
1. Minimal ROM with header
2. Header checksum verification
3. Global checksum verification
4. All SM83 instructions
5. Banking with MBC1

## Acceptance Criteria
- [ ] At least 8 new tests
- [ ] Header placement verified
- [ ] Checksums verified
- [ ] Instructions emit correctly

## Estimated Time: 2 hours
```

---

### Issue: Game Boy Hello World Example

**Title:** `[GB] Create hello-world example project`

**Labels:** `P1-important`, `gameboy`, `example`, `documentation`

**Parent:** #48

**Description:**

```markdown
## Summary
Create a complete Game Boy hello-world example.

## Contents
```
examples/gb-hello-world/
‚îú‚îÄ‚îÄ main.pasm
‚îú‚îÄ‚îÄ poppy.json
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ include/
    ‚îî‚îÄ‚îÄ hardware.inc
```

## Acceptance Criteria
- [ ] Compiles without errors
- [ ] Runs in bgb
- [ ] Displays text or graphics
- [ ] Well-documented

## Estimated Time: 2 hours
```

---

### Issue: Game Boy Development Guide

**Title:** `[Docs] Game Boy development guide`

**Labels:** `P1-important`, `gameboy`, `documentation`

**Parent:** #46

**Description:**

```markdown
## Summary
Create comprehensive Game Boy development guide similar to snes-guide.md.

## Contents
1. Getting Started
2. SM83 Processor Overview
3. Memory Map
4. Hardware Registers
5. Graphics System (tiles, BG, sprites)
6. Sound System
7. Input Handling
8. Banking (MBC)
9. Header Configuration
10. Example Programs

## Acceptance Criteria
- [ ] Complete SM83 reference
- [ ] All GB directives documented
- [ ] Working examples
- [ ] Linked from README

## Estimated Time: 3 hours
```

---

### Issue: Publish VS Code Extension

**Title:** `[VSCode] Publish extension to marketplace`

**Labels:** `P0-critical`, `vscode`, `release`

**Parent:** #47

**Description:**

```markdown
## Summary
Publish the Poppy VS Code extension to the Visual Studio Marketplace.

## Tasks
1. Create Azure DevOps account (if needed)
2. Generate Personal Access Token
3. Update package.json version
4. Run `vsce package`
5. Run `vsce publish`
6. Verify on marketplace

## Acceptance Criteria
- [ ] Extension visible on marketplace
- [ ] Install works correctly
- [ ] All features functional

## Estimated Time: 1 hour
```

---

### Issue: v1.0.0 Release Preparation

**Title:** `[Release] Prepare v1.0.0 release`

**Labels:** `P0-critical`, `release`

**Description:**

```markdown
## Summary
Final preparations for v1.0.0 release.

## Checklist
- [ ] All P0 issues closed
- [ ] All tests passing
- [ ] CHANGELOG.md updated
- [ ] README.md version updated
- [ ] Version in .csproj updated
- [ ] Create release notes
- [ ] Tag commit as v1.0.0
- [ ] Create GitHub release
- [ ] Attach binaries
- [ ] Announce release

## Acceptance Criteria
- [ ] Clean release tag
- [ ] GitHub release created
- [ ] Binaries attached
- [ ] Documentation complete

## Estimated Time: 4 hours
```

---

### Issue: ca65 Migration Guide

**Title:** `[Docs] Migration guide from ca65`

**Labels:** `P2-nice-to-have`, `documentation`

**Parent:** #46

**Description:**

```markdown
## Summary
Create migration guide for ca65 users switching to Poppy.

## Contents
1. Syntax differences
2. Directive mapping
3. Macro differences
4. Build system changes
5. Common gotchas

## Estimated Time: 2 hours
```

---

### Issue: ASAR Migration Guide

**Title:** `[Docs] Migration guide from ASAR`

**Labels:** `P2-nice-to-have`, `documentation`

**Parent:** #46

**Description:**

```markdown
## Summary
Create migration guide for ASAR users switching to Poppy.

## Contents
1. Syntax differences
2. Directive mapping
3. ROM hacking vs building differences
4. Patching workflow

## Estimated Time: 2 hours
```

---

### Issue: Project File Format

**Title:** `[Project] Define poppy.json project format`

**Labels:** `P2-nice-to-have`, `enhancement`

**Parent:** #45 (Project System Epic)

**Description:**

```markdown
## Summary
Define and implement poppy.json project file format.

## Format
```json
{
  "name": "my-game",
  "version": "1.0.0",
  "target": "nes",
  "entry": "src/main.pasm",
  "output": "build/game.nes",
  "includes": ["src", "include"],
  "symbols": "build/game.sym"
}
```

## Implementation
1. Define JSON schema
2. Create ProjectFile class
3. Parse and validate
4. Integrate with CLI

## Estimated Time: 5 hours total
```

---

## üìä Issue Summary

| Priority | Count | Hours |
|----------|-------|-------|
| P0-critical | 6 | 13h |
| P1-important | 6 | 14h |
| P2-nice-to-have | 4 | 11h |
| **Total** | **16** | **38h** |

---

## üîÑ Issues to Close

| # | Title | Reason |
|---|-------|--------|
| #69 | .include directive | Already implemented |
| #9 | Include System Epic | Complete |
| #10 | Label System Epic | Complete |
| #11 | Directive System Epic | Complete |

---

*All issues should be created and linked to their parent epics.*
