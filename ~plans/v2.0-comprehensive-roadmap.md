# Poppy v2.0 Comprehensive Roadmap
# Multi-Platform Expansion and Project Format

**Version:** 2.0  
**Start Date:** January 11, 2026  
**Current Status:** In Progress (20% complete)  
**Last Updated:** January 15, 2026

## ğŸ“Š Executive Summary

Poppy v2.0 represents a major expansion of the compiler's capabilities, adding support for 10+ retro gaming platforms and introducing a modern project management system. The release includes two major epics:

1. **Epic #84:** Multi-Platform Expansion (8 platforms)
2. **Epic #94:** .poppy Project File Format

**Current Progress:**
- âœ… 2 platforms complete (Atari 2600, Atari Lynx 95%)
- âœ… 962 tests passing (+20 from previous release)
- ğŸ”„ 22 GitHub issues created
- ğŸ”„ Parser updates in progress
- â³ 8 platforms remaining

**Estimated Completion:** Q3 2026 (6-8 months)

## ğŸ¯ Goals

### Primary Goals
1. **Platform Support:** Add 10+ retro gaming platforms
2. **Project Management:** Create modern project packaging system
3. **Developer Experience:** Streamline workflow with templates and CLI tools
4. **Documentation:** Comprehensive guides for all platforms
5. **Test Coverage:** Maintain 95%+ test coverage

### Success Metrics
- [ ] 10+ platforms fully supported
- [ ] 1500+ tests passing
- [ ] .poppy format specification complete
- [ ] 10+ example projects
- [ ] 5+ migration guides
- [ ] 100% backward compatibility with v1.0

## ğŸ“… Timeline

### Phase 1: Foundation (Weeks 1-4) - IN PROGRESS âœ… 50%
**Goal:** Complete foundational platforms and parser updates

#### Week 1 (Jan 11-17) - COMPLETE âœ…
- [x] Atari 2600 implementation (#85)
- [x] Atari Lynx implementation (#86)
- [x] Test suite creation (28 tests)
- [x] v1.0.0 release
- [x] GitHub issue structure (#84 epic + 8 sub-issues)

#### Week 2 (Jan 18-24) - CURRENT WEEK ğŸ”„
- [ ] 65SC02 parser support (#93) - **HIGH PRIORITY**
  - [ ] Add BRA, PHX/PHY, PLX/PLY, STZ, TRB/TSB mnemonics
  - [ ] Add accumulator addressing for INC/DEC
  - [ ] Add absolute indexed indirect for JMP
  - [ ] Verify all 20 Lynx tests pass
- [ ] .poppy format specification finalization (#94)
- [ ] poppy.json manifest schema (#95)
- [ ] Begin archive extraction implementation (#96)

#### Week 3 (Jan 25-31)
- [ ] Complete .poppy archive extraction (#96)
- [ ] Complete .poppy archive creation (#97)
- [ ] CLI pack/unpack commands (#98)
- [ ] Project validation (#99)
- [ ] Basic project templates

#### Week 4 (Feb 1-7)
- [ ] poppy init command (#114)
- [ ] Project template refinement (#113)
- [ ] Documentation for .poppy format
- [ ] Integration tests for project system
- [ ] Phase 1 retrospective

### Phase 2: 6502 Family Expansion (Weeks 5-8)
**Goal:** Complete 6502-derivative platforms

#### Week 5-6 (Feb 8-21)
- [ ] HuC6280 instruction set (#108)
- [ ] TurboGrafx-16 ROM builder (#91)
- [ ] TG16 test suite
- [ ] TG16 example projects

#### Week 7-8 (Feb 22-Mar 7)
- [ ] SPC700 instruction set (#109)
- [ ] SNES audio support (#92)
- [ ] SPC700 test suite
- [ ] Audio example projects
- [ ] Phase 2 complete

### Phase 3: Z80 Platform (Weeks 9-12)
**Goal:** Add Z80-based platforms

#### Week 9-10 (Mar 8-21)
- [ ] Z80 instruction set (#106)
- [ ] Sega Master System ROM builder (#89)
- [ ] SMS test suite
- [ ] SMS example projects

#### Week 11-12 (Mar 22-Apr 4)
- [ ] Game Gear variant support
- [ ] VDP graphics support
- [ ] Sound chip integration
- [ ] Migration guide from WLA-DX
- [ ] Phase 3 complete

### Phase 4: 16-bit x86 Platform (Weeks 13-18)
**Goal:** Add WonderSwan (V30MZ)

#### Week 13-15 (Apr 5-25)
- [ ] V30MZ instruction set (#105) - **COMPLEX**
- [ ] x86 addressing modes
- [ ] 8086-compatible opcodes
- [ ] Initial test suite

#### Week 16-18 (Apr 26-May 16)
- [ ] WonderSwan ROM builder (#100)
- [ ] WonderSwan Color support
- [ ] Cartridge format handling
- [ ] Complete test suite
- [ ] Example projects
- [ ] Phase 4 complete

### Phase 5: 68000 Platform (Weeks 19-26)
**Goal:** Add Genesis/Mega Drive

#### Week 19-20 (May 17-30)
- [ ] Big-endian support (#103) - **CRITICAL**
- [ ] 16/32-bit value encoding
- [ ] Byte order handling
- [ ] Endianness tests

#### Week 21-24 (May 31-Jun 27)
- [ ] M68000 instruction set (#104) - **VERY COMPLEX**
- [ ] CISC addressing modes
- [ ] 68000 opcodes (hundreds)
- [ ] Instruction encoding tests

#### Week 25-26 (Jun 28-Jul 11)
- [ ] Genesis ROM builder (#101)
- [ ] ROM header (domestic/overseas)
- [ ] Checksum calculation
- [ ] Complete test suite
- [ ] Example projects
- [ ] Phase 5 complete

### Phase 6: ARM Platform (Weeks 27-36)
**Goal:** Add Game Boy Advance

#### Week 27-30 (Jul 12-Aug 8)
- [ ] ARM7TDMI instruction set (#107) - **EXTREMELY COMPLEX**
- [ ] ARM 32-bit instruction set
- [ ] Thumb 16-bit instruction set
- [ ] Mode switching
- [ ] Initial test suite

#### Week 31-34 (Aug 9-Sep 5)
- [ ] GBA ROM builder (#90)
- [ ] GBA BIOS integration
- [ ] Cartridge types
- [ ] DMA support
- [ ] Graphics/sound system

#### Week 35-36 (Sep 6-Sep 19)
- [ ] Complete test suite
- [ ] Example projects (2D/3D)
- [ ] Performance optimization
- [ ] Migration guide from devkitARM
- [ ] Phase 6 complete

### Phase 7: Polish & Release (Weeks 37-40)
**Goal:** Finalize v2.0 release

#### Week 37-38 (Sep 20-Oct 3)
- [ ] All platforms example projects (#110)
- [ ] Complete migration guides (#111)
- [ ] Platform-specific documentation
- [ ] Video tutorials (optional)

#### Week 39 (Oct 4-10)
- [ ] Roadmap update (#112)
- [ ] Release notes
- [ ] Changelog
- [ ] Website updates
- [ ] Marketing materials

#### Week 40 (Oct 11-17)
- [ ] Final testing (1500+ tests)
- [ ] Performance benchmarks
- [ ] Version 2.0.0 release ğŸ‰
- [ ] Celebration ğŸŠ

## ğŸ“‹ Issue Hierarchy

### Epic #84: Multi-Platform Expansion
```
Epic #84: v2.0 Multi-Platform Expansion
â”‚
â”œâ”€ âœ… #85: Atari 2600 (6507) - COMPLETE
â”‚
â”œâ”€ ğŸ”„ #86: Atari Lynx (65SC02) - 95% COMPLETE
â”‚  â””â”€ â³ #93: 65SC02 parser support
â”‚
â”œâ”€ â³ #87: WonderSwan (V30MZ)
â”‚  â”œâ”€ â³ #100: WonderSwan ROM format
â”‚  â””â”€ â³ #105: V30MZ instruction set
â”‚
â”œâ”€ â³ #88: Genesis/Mega Drive (68000)
â”‚  â”œâ”€ â³ #101: Genesis ROM format
â”‚  â”œâ”€ â³ #103: Big-endian support
â”‚  â””â”€ â³ #104: M68000 instruction set
â”‚
â”œâ”€ â³ #89: Sega Master System (Z80)
â”‚  â””â”€ â³ #106: Z80 instruction set
â”‚
â”œâ”€ â³ #90: Game Boy Advance (ARM7TDMI)
â”‚  â””â”€ â³ #107: ARM7TDMI instruction set
â”‚
â”œâ”€ â³ #91: TurboGrafx-16/PC Engine (HuC6280)
â”‚  â””â”€ â³ #108: HuC6280 instruction set
â”‚
â””â”€ â³ #92: SNES Audio (SPC700)
   â””â”€ â³ #109: SPC700 instruction set
```

### Epic #94: .poppy Project Format
```
Epic #94: .poppy Project File Format
â”‚
â”œâ”€ â³ #95: Manifest schema design
â”œâ”€ â³ #96: Archive extraction
â”œâ”€ â³ #97: Archive creation
â”œâ”€ â³ #98: CLI pack/unpack commands
â”œâ”€ â³ #99: Project validation
â”œâ”€ â³ #113: Project templates
â””â”€ â³ #114: poppy init command
```

### Supporting Issues
```
Documentation & Examples
â”‚
â”œâ”€ â³ #110: Example projects for all platforms
â”œâ”€ â³ #111: Platform-specific migration guides
â””â”€ â³ #112: Update roadmap with timeline
```

## ğŸ—ï¸ Architecture Changes

### New Components

#### Code Generation
- `InstructionSet6507.cs` âœ…
- `InstructionSet65SC02.cs` âœ…
- `InstructionSetHuC6280.cs` â³
- `InstructionSetSPC700.cs` â³
- `InstructionSetZ80.cs` â³
- `InstructionSetV30MZ.cs` â³
- `InstructionSetM68000.cs` â³
- `InstructionSetARM7TDMI.cs` â³

#### ROM Builders
- `Atari2600RomBuilder.cs` âœ…
- `AtariLynxRomBuilder.cs` âœ…
- `TurboGrafx16RomBuilder.cs` â³
- `SnesAudioRomBuilder.cs` â³
- `SegaMasterSystemRomBuilder.cs` â³
- `WonderSwanRomBuilder.cs` â³
- `GenesisRomBuilder.cs` â³
- `GameBoyAdvanceRomBuilder.cs` â³

#### Project Management
- `ProjectManifest.cs` â³ (poppy.json model)
- `ProjectArchive.cs` â³ (ZIP handling)
- `ProjectValidator.cs` â³
- `ProjectTemplate.cs` â³
- `ArchiveCreator.cs` â³
- `ArchiveExtractor.cs` â³

#### CLI Commands
- `PackCommand.cs` â³
- `UnpackCommand.cs` â³
- `InitCommand.cs` â³
- `ValidateCommand.cs` â³

### Parser Updates
- Enhanced mnemonic recognition for:
  - 65SC02 (BRA, PHX/PHY, STZ, etc.)
  - HuC6280 (block transfer, etc.)
  - Z80 (full instruction set)
  - V30MZ (x86 opcodes)
  - M68000 (CISC instructions)
  - ARM7TDMI (ARM + Thumb)

## ğŸ“ Learning Curve

### Complexity Ratings

| Platform | CPU | Complexity | Estimated Effort |
|----------|-----|------------|------------------|
| Atari 2600 | 6507 | â­ Simple | 1 week âœ… |
| Atari Lynx | 65SC02 | â­â­ Easy | 2 weeks âœ… |
| TG16/PCE | HuC6280 | â­â­ Easy | 2-3 weeks |
| SPC700 | SPC700 | â­â­â­ Medium | 3-4 weeks |
| SMS/GG | Z80 | â­â­â­ Medium | 3-4 weeks |
| WonderSwan | V30MZ | â­â­â­â­ Hard | 5-6 weeks |
| Genesis | 68000 | â­â­â­â­â­ Very Hard | 7-8 weeks |
| GBA | ARM7TDMI | â­â­â­â­â­ Very Hard | 9-10 weeks |

**Total Estimated Effort:** 32-40 weeks of development

### Knowledge Requirements
- **6502 Family:** Already mastered âœ…
- **Z80:** New architecture (8-bit, different instruction set)
- **x86:** Complex CISC, segmented memory
- **68000:** Complex CISC, 32-bit registers
- **ARM:** RISC, two instruction sets (ARM/Thumb)

## ğŸ“š Documentation Plan

### User Documentation
- [ ] Platform comparison guide
- [ ] Getting started for each platform
- [ ] .poppy format user guide
- [ ] Template creation guide
- [ ] Best practices guide
- [ ] FAQ for each platform

### Technical Documentation
- [ ] Instruction set reference for each CPU
- [ ] ROM format specifications
- [ ] Archive format specification
- [ ] API documentation
- [ ] Architecture diagrams
- [ ] Code examples

### Migration Guides
- [ ] ASAR â†’ Poppy (SNES) âœ…
- [ ] ca65 â†’ Poppy (NES) âœ…
- [ ] RGBDS â†’ Poppy (GB)
- [ ] DASM â†’ Poppy (Atari 2600)
- [ ] WLA-DX â†’ Poppy (SMS)
- [ ] devkitARM â†’ Poppy (GBA)

## ğŸ§ª Testing Strategy

### Test Coverage Goals
- **Unit Tests:** 95%+ coverage for all instruction sets
- **Integration Tests:** ROM building for all platforms
- **End-to-End Tests:** Full compilation pipeline
- **Regression Tests:** Ensure v1.0 compatibility

### Test Counts by Component
| Component | Current | Target |
|-----------|---------|--------|
| 6507 (Atari 2600) | 8 âœ… | 8 |
| 65SC02 (Lynx) | 20 (13 passing) ğŸ”„ | 20 |
| HuC6280 (TG16) | 0 | 25 |
| SPC700 (SNES Audio) | 0 | 30 |
| Z80 (SMS) | 0 | 40 |
| V30MZ (WonderSwan) | 0 | 50 |
| M68000 (Genesis) | 0 | 60 |
| ARM7TDMI (GBA) | 0 | 80 |
| .poppy Format | 0 | 30 |
| **TOTAL** | **969** | **1500+** |

## ğŸš€ Release Strategy

### Version Numbering
- **v2.0.0-alpha.1:** After TG16 + SPC700 complete
- **v2.0.0-alpha.2:** After SMS/Z80 complete
- **v2.0.0-beta.1:** After WonderSwan complete
- **v2.0.0-beta.2:** After Genesis complete
- **v2.0.0-rc.1:** After GBA complete
- **v2.0.0:** Final release (October 2026)

### Release Criteria
Each alpha/beta must have:
- [ ] All platforms for that phase 100% working
- [ ] 95%+ test coverage
- [ ] Documentation complete
- [ ] Example projects
- [ ] Migration guides
- [ ] No critical bugs

### Marketing & Outreach
- [ ] Blog posts for each platform release
- [ ] Twitter/social media announcements
- [ ] Reddit posts in retro gaming communities
- [ ] YouTube tutorials (optional)
- [ ] Conference talks (optional)

## ğŸ”„ Dependencies

### Critical Path
```
Week 1-2: Parser updates (#93)
    â†“
Week 2-4: .poppy format (#94-#99, #114)
    â†“
Week 5-8: 6502 family (TG16, SPC700)
    â†“
Week 9-12: Z80 (SMS)
    â†“
Week 13-18: V30MZ (WonderSwan)
    â†“
Week 19-20: Big-endian support (#103)
    â†“
Week 21-26: M68000 (Genesis)
    â†“
Week 27-36: ARM7TDMI (GBA)
    â†“
Week 37-40: Polish & release
```

### Parallel Workstreams
- Documentation can be written during implementation
- Example projects can be created after each platform
- Migration guides can be written anytime
- Test suites must be created with implementation

## âš ï¸ Risks & Mitigation

### High-Risk Items
1. **ARM7TDMI complexity** (GBA)
   - Mitigation: Allocate 10 weeks, create detailed spec first
   - Fallback: Release v2.0 without GBA, add in v2.1

2. **Big-endian support** (Genesis)
   - Mitigation: Implement early (Week 19), test thoroughly
   - Impact: Blocks Genesis and affects other platforms

3. **V30MZ x86 complexity** (WonderSwan)
   - Mitigation: Study existing x86 assemblers (NASM, MASM)
   - Fallback: Implement subset of x86 instructions

4. **Parser scalability**
   - Mitigation: Refactor parser early if needed
   - Monitor: Performance with large instruction sets

### Medium-Risk Items
- Z80 undocumented opcodes
- SPC700 audio DSP integration
- .poppy format adoption
- Test suite maintenance overhead

## ğŸ“Š Success Metrics

### Quantitative
- [ ] 10+ platforms supported
- [ ] 1500+ tests passing
- [ ] 95%+ test coverage
- [ ] < 100ms compilation time for small projects
- [ ] Zero critical bugs
- [ ] 100% backward compatibility

### Qualitative
- [ ] Positive community feedback
- [ ] Active user adoption
- [ ] Contributors to project
- [ ] Referenced in retro dev communities
- [ ] Used for released games

## ğŸ‰ Milestones

- [x] **Jan 11:** v2.0 development start
- [x] **Jan 15:** v1.0.0 release + Atari platforms âœ…
- [ ] **Jan 24:** Parser updates complete
- [ ] **Feb 7:** .poppy format complete
- [ ] **Mar 7:** 6502 family complete (TG16, SPC700)
- [ ] **Apr 4:** Z80 complete (SMS)
- [ ] **May 16:** V30MZ complete (WonderSwan)
- [ ] **Jul 11:** M68000 complete (Genesis)
- [ ] **Sep 19:** ARM7TDMI complete (GBA)
- [ ] **Oct 17:** v2.0.0 final release ğŸ‰

## ğŸ“ Communication

### Status Updates
- Weekly status in commit messages
- Session logs for each work session
- GitHub issue updates
- README.md badges for progress

### Community Engagement
- Discord server (future)
- GitHub Discussions
- Issue tracker
- Pull requests welcome

---

**Last Updated:** January 15, 2026  
**Next Review:** January 22, 2026  
**Status:** âœ… On Track (Phase 1: 50% complete)
